<html><body>
    <canvas id="field" style="border:solid" width="110" height="110"></canvas>
    <script>
    var c, width, height, goal, snakes;

function Point(x,y){
  var x,y;
  this.x=x;
  this.y=y;
}

function init() {
  var canvas = document.getElementById("field");
  c = canvas.getContext("2d");
  height = canvas.height;
  width = canvas.width;
  snakes = new Array();
  snakes[0] = {
    points:0,
    loc:new Point(1,1),
    dir:1,
    move:function(){
      if(this.dir!=-1){
        var plan=0;
        if(this.loc.x<goal.x)
          plan=1;
        else if(this.loc.x>goal.x)
          plan=3;
        else if(this.loc.y<goal.y)
          plan=2;
         else if(this.loc.y>goal.y)
          plan=0;

        this.dir=plan;
        
        //console.log(free(this.loc.x,this.loc.y));
        if(free(newPos(this.loc, this.dir))==true){
        	//this.loc=newPos(this.loc, this.dir);
        } else {
          this.dir=-1;
          this.color='#f00';
        }
      }
    },
    color:'#0ff',
    tail:new Array()
	};
  c.save();
  goal = { x:0,y:0 };
  goal.x=Math.floor(10*Math.random());
  goal.y=Math.floor(10*Math.random());
  loop();
}

function newPos(p, dir){
  if(dir==0)
    p.y-=1;
  if(dir==1)
    p.x+=1;
  if(dir==2)
    p.y+=1;
  if(dir==3)
    p.x-=1;
  return p;
}

function draw(x, y, color){
	c.fillStyle=color;
  c.fillRect(x*10,y*10,8,8);
}

function free(p){
  if(p.x<0 || p.y<0 || p.x>10 || p.y>10)
    return false;
  /*snakes.forEach(function(snake) {
    if(snake.loc.x==p.x && snake.loc.y==p.y)
      return false;
    snake.tail.forEach(function(t) {
   	 if(t.x==p.x && t.y==p.y)
      	return false;
    });
  });*/
  return true;
}

function loop(){
  c.clearRect(0, 0, width, height);
  draw(goal.x, goal.y, '#ff0');
  
  snakes.forEach(function(snake) {
    draw(snake.loc.x, snake.loc.y, snake.color);
    var oldX=snake.loc.x;
    var oldY=snake.loc.y;
    snake.move();
    snake.tail.pop();
    snake.tail.unshift(new Point(oldX,oldY));
    snake.tail.forEach(function(t) {
      draw(t.x, t.y, snake.color);
    });
    if(snake.loc.x==goal.x, snake.loc.y==goal.y){
      snake.points++;
      //console.log(snake);
      snake.tail.push(new Point(1,1));
  		goal.x=Math.floor(10*Math.random());
  		goal.y=Math.floor(10*Math.random());
    }
	});
  
  setTimeout(loop , 100);
}

init();
    </script>
</body></html>