<html><body style="background-color:#222;">
    <canvas id="field" style="border:solid" width="110" height="110"></canvas>
    <script>
    var c, width, height, goal, snakes;

function Point(x,y){
  var x,y;
  this.x=x;
  this.y=y;
}

function init() {
    // fix js modulo bug
    Number.prototype.mod = function(n) {
        return ((this%n)+n)%n;
    }
    
    var canvas = document.getElementById("field");
    c = canvas.getContext("2d");
    height = canvas.height;
    width = canvas.width;
    snakes = new Array();
    snakes[0] = {
        points:0,
        loc:new Point(1,1),
        dir:1,
        colorHead:'#0ff',
        colorTail:'#0cc',
        tail:new Array(),
        occupying:function(p){
            var occ = false;
            if(this.loc.x==p.x && this.loc.y==p.y)
                occ = true;
            else {
                this.tail.forEach(function(t) {
                    if(t.x==p.x && t.y==p.y)
                        occ = true;
                });
            }
            return occ;
        },
        move:function(){
            if(this.dir!=-1){
                var plan=0;
                if(this.loc.x<goal.x)
                    plan=1;
                else if(this.loc.x>goal.x)
                    plan=3;
                else if(this.loc.y<goal.y)
                    plan=2;
                else if(this.loc.y>goal.y)
                    plan=0;

                if(free(newPos(this.loc, plan))==true){
                    this.dir=plan;
                } else if(free(newPos(this.loc, this.dir))==true){ //straight
                    //console.log("straight");
                    //this.dir=this.dir;
                } else if(free(newPos(this.loc, (this.dir-1).mod(4)))==true){ //left
                    //console.log("left"+((this.dir-1).mod(4)));
                    this.dir=(this.dir-1).mod(4);
                } else if(free(newPos(this.loc, (this.dir+1).mod(4)))==true){ //right
                    //console.log("right"+((this.dir+1).mod(4)));
                    this.dir=(this.dir+1).mod(4);
                }

            if(free(newPos(this.loc, this.dir))==true){
                this.loc=newPos(this.loc, this.dir);
            } else {
              this.dir=-1;
              this.colorTail='#f00';
            }
          }
        }
    };
    snakes[1] = {
        points:0,
        loc:new Point(9,1),
        dir:1,
        colorHead:'#77f',
        colorTail:'#55c',
        tail:new Array(),
        occupying:function(p){
            var occ = false;
            if(this.loc.x==p.x && this.loc.y==p.y)
                occ = true;
            else {
                this.tail.forEach(function(t) {
                    if(t.x==p.x && t.y==p.y)
                        occ = true;
                });
            }
            return occ;
        },
        move:function(){
            if(this.dir!=-1){
                var plan=0;
                if(Math.abs(this.loc.x-goal.x)>Math.abs(this.loc.y-goal.y)){
                    if(this.loc.x<goal.x)
                        plan=1;
                    else if(this.loc.x>goal.x)
                        plan=3;
                } else {
                    if(this.loc.y<goal.y)
                        plan=2;
                    else if(this.loc.y>goal.y)
                        plan=0;
                }
                
                if(free(newPos(this.loc, plan))==true){
                    this.dir=plan;
                } else if(free(newPos(this.loc, this.dir))==true){ //straight
                    //console.log("straight");
                    //this.dir=this.dir;
                } else if(free(newPos(this.loc, (this.dir-1).mod(4)))==true){ //left
                    //console.log("left"+((this.dir-1).mod(4)));
                    this.dir=(this.dir-1).mod(4);
                } else if(free(newPos(this.loc, (this.dir+1).mod(4)))==true){ //right
                    //console.log("right"+((this.dir+1).mod(4)));
                    this.dir=(this.dir+1).mod(4);
                }

            if(free(newPos(this.loc, this.dir))==true){
                this.loc=newPos(this.loc, this.dir);
            } else {
              this.dir=-1;
              this.colorTail='#f00';
            }
          }
        }
    };
    c.save();
    goal = { x:0,y:0 };
    goal.x=Math.floor(10*Math.random());
    goal.y=Math.floor(10*Math.random());
    loop();
}

function newPos(p, dir){
    var c=new Point(p.x,p.y);
    if(dir==0)
        c.y-=1;
    if(dir==1)
        c.x+=1;
    if(dir==2)
        c.y+=1;
    if(dir==3)
        c.x-=1;
  return c;
}

function draw(x, y, color){
	c.fillStyle=color;
    c.fillRect(x*9,y*9,2,2);
    c.fillRect(x*9,y*9+3,2,2);
    c.fillRect(x*9,y*9+6,2,2);
    c.fillRect(x*9+3,y*9,2,2);
    c.fillRect(x*9+3,y*9+3,2,2);
    c.fillRect(x*9+3,y*9+6,2,2);
    c.fillRect(x*9+6,y*9,2,2);
    c.fillRect(x*9+6,y*9+3,2,2);
    c.fillRect(x*9+6,y*9+6,2,2);
}

function free(p){
    var isFree = true;
    if(p.x<0 || p.y<0 || p.x>10 || p.y>10)
        isFree = false;
    snakes.forEach(function(snake) {
        if(snake.occupying(p)){
            isFree = false;
        }
    });
    return isFree;
}

function loop(){
  c.clearRect(0, 0, width, height);
  draw(goal.x, goal.y, '#ff0');
  
  snakes.forEach(function(snake) {
    if(snake.dir!=-1){
        var oldX=snake.loc.x;
        var oldY=snake.loc.y;
        snake.move();
        snake.tail.pop();
        snake.tail.unshift(new Point(oldX,oldY));
    }
    draw(snake.loc.x, snake.loc.y, snake.colorHead);
    snake.tail.forEach(function(t) {
      draw(t.x, t.y, snake.colorTail);
    });
    if(snake.loc.x==goal.x, snake.loc.y==goal.y){
      snake.points++;
      //console.log(snake);
      snake.tail.push(new Point(1,1));
        while(free(goal)==false){
            goal.x=Math.floor(10*Math.random());
            goal.y=Math.floor(10*Math.random());
        }
    }
	});
  
  setTimeout(loop , 100);
}

init();
    </script>
</body></html>